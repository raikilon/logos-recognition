# Prototypes
This directory contains all the prototypes developed to test all the technologies discussed in this Bachelor thesis. These prototypes are developed only to illustrate the general working principles and therefore the code is not optimized for speed, memory consumption and recognition performance.

## Contents

Here are listed all the files and subdirectories and their use.

- [Requirements](requirements.txt) - Contains all the needed packages to run the different prototypes contained in this directory
- [ImageJ Macro](ImageJ_macro_for_test_images.ijm) - Macro for [ImageJ](https://fiji.sc/) to apply different operation (rotation, noise, blur, etc.) to the test image in an automated way
- [Classification with pairs](classification_with_pairs) - This subdirectory contains two files used to classify the different logos with different logos pairs (MasterCard vs Others, etc.)
  - [Classifier](classification_with_pairs/Classifier.py) - This prototype uses different classification techniques and prints their results
  - [Features](classification_with_pairs/Features.py) - This prototype implements the Bag of Words model for image classification
  - [Results](classification_with_pairs/results) - This subdirectory contains all the results obtained with the classification with pairs
- [Classification without pairs](classification_without_pairs (outdated)) - This subdirectory contains two files used to classify the different logos without different logos pairs (MasterCard vs Others, etc.). In fact, the classification performed here compare all the logos classes together (worse result)
  - [Classifier](classification_without_pairs (outdated)/Classifier.py) - This prototype uses different classification techniques and prints their results
  - [Features](classification_without_pairs (outdated)/Features.py) - This prototype implements the Bag of Words model for image classification
  - [Results](classification_without_pairs (outdated)/results/) - This subdirectory contains all the results obtained with the classification without pairs
- [Confusion matrix plot](confusion_matrix_plot.py) - Script that given a confusion matrix. It plots the result in a prettier way
- [Artificial Neural Network](matlab_ann) - This subdirectory contains all the files needed to generated a neural network to classify the BoW histograms (Matlab)
  - [Data](matlab_ann/data.mat) - This file contains the data for the training process
  - [Results](matlab_ann/results.mat) - This file contains the expected results. They are used to train the neural network
  - [Neural Network](matlab_ann/neural_network.m) - This file contains all the steps needed to generate the two above cited file (data and results) from the raw data generated by the classification without pairs
  - [Neural Network Generation](matlab_ann/neural_network_generation.m) - This file generates the neural network, trains it and prints the results. The generation of this neural network uses the MatLab  neural network toolbox.
- [Selective Search](selective_search) - This directory contains the prototype to recognize multiple logos in a single image
  - [Classifier](selective_search/selective_classifier.py) - This file allow to classify multiple logos in a single image. Please follow the information contained in it.
  - [Selective Search test](selective_search/selective_search_test.py) - This script contains two technologies for the selective search. The script return the given image with all the bounding boxes drew on it
  - [Bounding Boxes](selective_search/boundingbox.txt) - This file contains all the bounding boxes of the true positives (all logos) for the hard negatives generation. This file must contain the name of the logo and then the different bounding boxes in the following format: numberOfTheImage_xAngleTopLeft, yAngleTopLeft, xAngleBottomRight, yAngleBottomRight (without spaces). The logos names must be on the same order of the [classes file](selective_search/train/classes.txt).
  - [Values](selective_search/values.txt) - This file contains information about the presences of the logos for each test image. The file must contain the logos contained in the processed image separated by "," (from image 1 to n).
  - [Classes](selective_search/train/classes.txt) - This file contains the name of all the processed classes (DHL, PayPal, MasterCard, etc.)
  - [Results](selective_search/results) - This subdirectory contains all the results 
- [Images extraction](images_extraction) - This script allow to download all the images from a given website

## Installation

These prototypes require [python](https://www.python.org/) 3.6.2+ to run.

To install all the dependencies run the following command
```
pip install -r requirements.txt
```




## Credits
The project was realized by **Noli Manzoni** (noli.manzoni@students.bfh.ch) for the module [Bachelor Thesis](https://www.ti.bfh.ch/fileadmin/modules/BTI7321-de.xml) at the  [Bern University of Applied Sciences](https://www.bfh.ch).